% ***************************************************************************
% ***************************************************************************
% ***************************************************************************
% ***************************************************************************
% ***************************************************************************
% DO NOT EDIT THIS FILE
% 
% This file was generated from 'input/registers-alt.tex.template', version 1.1
% by the script 'wuppercodegen', version: xx.yy.zz, using the following commandline:
% 
% ./wuppercodegen/cli.py input/test-registers.yaml input/registers-alt.tex.template output/registers-alt.tex
% 
% Please do NOT edit this file, but edit the source file at 'input/registers-alt.tex.template'
% 
% ***************************************************************************
% ***************************************************************************
% ***************************************************************************
% ***************************************************************************
% ***************************************************************************

\title{\large Wupper \small a PCIe DMA Engine for FELIX}
\input{../et_template/template.tex}
\date{\SetDocumentDate}
\def\DocVer{Rev 3.3}
\def\SetDocumentDate{24-08-2015}
\begin{document}

\section{FELIX register map}

BAR2 stores registers for the control and monitor of HDL modules inside the FPGA other than Wupper. A portion of this register map's section is dedicated for control and monitor of devices outside the FPGA; as for example simple SPI and I2C devices. The offset for BAR2 is usually 0xFB900000.

%\begin{landscape}
\begin{longtabu} to \textwidth {|X[1.5,l]|X[3,l]|X[4,l]|X[1,l]|X[1,l]|X[5,l]|}
\hline
\textbf{Address} & \multicolumn{2}{|l|}{\textbf{Name/Field}} &\textbf{Bits} &{\textbf{Type}} &\textbf{Description} \\
\hline
\endhead

\multicolumn{6}{|c|}{Bar2} \\
\hline
\multicolumn{6}{|c|}{Generic Board Information} \\
\hline
0x0000 & \multicolumn{2}{|l|}{BOARD\_ID\_SVN} &
15:0 & R & Board ID SVN Revision \\
\hline
0x0010 & \multicolumn{2}{|l|}{BOARD\_ID\_TIMESTAMP} &
39:0 & R & Board ID Date / Time in BCD format YYMMDDhhmm \\
\hline
0x0020 & \multicolumn{2}{|l|}{STATUS\_LEDS} &
7:0 & W & Board GPIO Leds \\
\hline
0x0030 & \multicolumn{5}{|l|}{GENERIC\_CONSTANTS} \\
\cline{2-6}
 & & INTERRUPTS & 15:8 & R & Number of Interrupts \\
 & & DESCRIPTORS & 7:0 & R & Number of Descriptors \\
\hline
0x0040 & \multicolumn{2}{|l|}{NUM\_OF\_CHANNELS} &
7:0 & R & Number of GBT Channels \\
\hline
0x0050 & \multicolumn{2}{|l|}{CARD\_TYPE} &
63:0 & R & Card Type:\newline   - 709: VC709\newline   - 710: HTG710\newline  \\
\hline
0x0060 & \multicolumn{2}{|l|}{GBT\_MAPPING} &
7:0 & R & CXP-to-GBT mapping:\newline   0: NORMAL CXP1 1-12 CXP2 13-24\newline   1: ALTERNATE CXP1 1-4,9-12,17-20\newline  \\
\hline
\multicolumn{6}{|c|}{Central Router Controls} \\
\hline
\multicolumn{6}{|c|}{CR\_GBT\_CTRL} \\
\hline
\multicolumn{6}{|c|}{EGROUP\_TH} \\
\hline
0x1100 & \multicolumn{2}{|l|}{CR\_TH\_GBT00\_EGROUP0\_CTRL} &
63:0 & W & See Central Router Doc, indices [5,6] are optimized out in wideMode \\
\hline
\multicolumn{6}{|c|}{\ldots} \\
\hline
0x1160 & \multicolumn{2}{|l|}{CR\_TH\_GBT00\_EGROUP6\_CTRL} &
63:0 & W & See Central Router Doc, indices [5,6] are optimized out in wideMode \\
\hline
\multicolumn{6}{|c|}{EGROUP\_FH} \\
\hline
0x1170 & \multicolumn{2}{|l|}{CR\_FH\_GBT00\_EGROUP0\_CTRL} &
63:0 & W & See Central Router Doc, indices [3,4] are optimized out in wideMode \\
\hline
\multicolumn{6}{|c|}{\ldots} \\
\hline
0x11B0 & \multicolumn{2}{|l|}{CR\_FH\_GBT00\_EGROUP4\_CTRL} &
63:0 & W & See Central Router Doc, indices [3,4] are optimized out in wideMode \\
\hline
\multicolumn{6}{|c|}{\ldots} \\
\hline
\multicolumn{6}{|c|}{EGROUP\_TH} \\
\hline
0x2240 & \multicolumn{2}{|l|}{CR\_TH\_GBT23\_EGROUP0\_CTRL} &
63:0 & W & See Central Router Doc, indices [5,6] are optimized out in wideMode \\
\hline
\multicolumn{6}{|c|}{\ldots} \\
\hline
0x22A0 & \multicolumn{2}{|l|}{CR\_TH\_GBT23\_EGROUP6\_CTRL} &
63:0 & W & See Central Router Doc, indices [5,6] are optimized out in wideMode \\
\hline
\multicolumn{6}{|c|}{EGROUP\_FH} \\
\hline
0x22B0 & \multicolumn{2}{|l|}{CR\_FH\_GBT23\_EGROUP0\_CTRL} &
63:0 & W & See Central Router Doc, indices [3,4] are optimized out in wideMode \\
\hline
\multicolumn{6}{|c|}{\ldots} \\
\hline
0x22F0 & \multicolumn{2}{|l|}{CR\_FH\_GBT23\_EGROUP4\_CTRL} &
63:0 & W & See Central Router Doc, indices [3,4] are optimized out in wideMode \\
\hline
0x2300 & \multicolumn{2}{|l|}{CR\_TH\_UPDATE\_CTRL} &
any & T & See Central Router Doc \\
\hline
0x2310 & \multicolumn{2}{|l|}{CR\_FH\_UPDATE\_CTRL} &
any & T & See Central Router Doc \\
\hline
\multicolumn{6}{|c|}{Central Router Monitors} \\
\hline
\multicolumn{6}{|c|}{CR\_GBT\_MON} \\
\hline
0x3000 & \multicolumn{2}{|l|}{CR\_TH\_GBT00\_MON} &
63:0 & R & See Central Router Doc \\
\hline
0x3010 & \multicolumn{2}{|l|}{CR\_FH\_GBT00\_MON} &
63:0 & R & See Central Router Doc \\
\hline
\multicolumn{6}{|c|}{\ldots} \\
\hline
0x32E0 & \multicolumn{2}{|l|}{CR\_TH\_GBT23\_MON} &
63:0 & R & See Central Router Doc \\
\hline
0x32F0 & \multicolumn{2}{|l|}{CR\_FH\_GBT23\_MON} &
63:0 & R & See Central Router Doc \\
\hline
\multicolumn{6}{|c|}{GBT Emulator Controls And Monitors} \\
\hline
0x4000 & \multicolumn{5}{|l|}{GBT\_EMU\_ENA} \\
\cline{2-6}
 & & TOHOST & 1 & W & Enable GBT dummy emulator ToHost \\
 & & TOFRONTEND & 0 & W & Enable GBT dummy emulator ToFrontEnd \\
\hline
0x4010 & \multicolumn{2}{|l|}{GBT\_EMU\_CONFIG\_WE\_ARRAY} &
6:0 & W & write enable array, every bit is one emulator RAM block \\
\hline
0x4020 & \multicolumn{5}{|l|}{GBT\_EMU\_CONFIG} \\
\cline{2-6}
 & & WRADDR & 45:32 & W & write address bus \\
 & & WRDATA & 15:0 & W & write data bus \\
\hline
\multicolumn{6}{|c|}{GBT Wrapper Controls} \\
\hline
0x5400 & \multicolumn{2}{|l|}{GBT\_LOGIC\_RESET} &
63:0 & W & Not internally connected (?) \\
\hline
0x5410 & \multicolumn{2}{|l|}{GBT\_GENERAL\_CTRL} &
0 & W & Alignment chk reset (not self clearing) \\
\hline
0x5420 & \multicolumn{5}{|l|}{GBT\_MODE\_CTRL} \\
\cline{2-6}
 & & DESMUX\_USE\_SW & 2 & W & DESMUX\_USE\_SW \\
 & & RX\_ALIGN\_SW & 1 & W & RX\_ALIGN\_SW \\
 & & RX\_ALIGN\_TB\_SW & 0 & W & RX\_ALIGN\_TB\_SW \\
\hline
0x5480 & \multicolumn{5}{|l|}{GBT\_RXSLIDE} \\
\cline{2-6}
 & & BF1 & 59:48 & W & RxSlide select [23:12] \\
 & & BF2 & 43:32 & W & RxSlide select [11:0] \\
 & & BF3 & 27:16 & W & RxSlide manual [23:12 \\
 & & BF4 & 11:0 & W & RxSlide manual [11:0] \\
\hline
0x5490 & \multicolumn{5}{|l|}{GBT\_TXUSRRDY} \\
\cline{2-6}
 & & BF1 & 27:16 & W & TxUsrRdy [23:12] \\
 & & BF2 & 11:0 & W & TxUsrRdy [11:0] \\
\hline
0x54A0 & \multicolumn{5}{|l|}{GBT\_RXUSRRDY} \\
\cline{2-6}
 & & BF1 & 27:16 & W & RxUsrRdy [23:12] \\
 & & BF2 & 11:0 & W & RxUsrRdy [11:0] \\
\hline
0x54B0 & \multicolumn{5}{|l|}{GBT\_GTTX\_RESET} \\
\cline{2-6}
 & & BF1 & 30:28 & W & SOFT\_RESET [5:3] \\
 & & BF2 & 27:16 & W & GTTX\_RESET [23:12] \\
 & & BF3 & 14:12 & W & SOFT\_RESET [2:0] \\
 & & BF4 & 11:0 & W & GTTX\_RESET [11:0] \\
\hline
0x54C0 & \multicolumn{5}{|l|}{GBT\_GTRX\_RESET} \\
\cline{2-6}
 & & BF1 & 27:16 & W & GTRX\_RESET [23:0] \\
 & & BF2 & 11:0 & W & GTRX\_RESET [11:0] \\
\hline
0x54D0 & \multicolumn{5}{|l|}{GBT\_PLL\_RESET} \\
\cline{2-6}
 & & BF1 & 30:28 & W & QPLL\_RESET [5:3] \\
 & & BF2 & 27:16 & W & CPLL\_RESET [23:12] \\
 & & BF3 & 14:12 & W & QPLL\_RESET [2:0] \\
 & & BF4 & 11:0 & W & CPLL\_RESET [11:0] \\
\hline
0x54E0 & \multicolumn{5}{|l|}{GBT\_SOFT\_TX\_RESET} \\
\cline{2-6}
 & & BF1 & 30:28 & W & SOFT\_TX\_RESET\_ALL [5:3] \\
 & & BF2 & 27:16 & W & SOFT\_TX\_RESET\_GT [23:12] \\
 & & BF3 & 14:12 & W & SOFT\_TX\_RESET\_ALL [2:0] \\
 & & BF4 & 11:0 & W & SOFT\_TX\_RESET\_GT [11:0] \\
\hline
0x54F0 & \multicolumn{5}{|l|}{GBT\_SOFT\_RX\_RESET} \\
\cline{2-6}
 & & BF1 & 30:28 & W & SOFT\_RX\_RESET\_ALL [5:3] \\
 & & BF2 & 27:16 & W & SOFT\_RX\_RESET\_GT [23:12] \\
 & & BF3 & 14:12 & W & SOFT\_RX\_RESET\_ALL [2:0] \\
 & & BF4 & 11:0 & W & SOFT\_RX\_RESET\_GT [11:0] \\
\hline
0x5500 & \multicolumn{5}{|l|}{GBT\_ODD\_EVEN} \\
\cline{2-6}
 & & BF1 & 27:16 & W & OddEven [23:12] \\
 & & BF2 & 11:0 & W & OddEven [11:0] \\
\hline
0x5510 & \multicolumn{5}{|l|}{GBT\_TOPBOT} \\
\cline{2-6}
 & & BF1 & 27:16 & W & TopBot [23:12] \\
 & & BF2 & 11:0 & W & TopBot [11:0] \\
\hline
0x5520 & \multicolumn{2}{|l|}{GBT\_TX\_TC\_DLY\_VALUE1} &
47:0 & W & TX\_TC\_DLY\_VALUE [47:0] \\
\hline
0x5530 & \multicolumn{2}{|l|}{GBT\_TX\_TC\_DLY\_VALUE2} &
47:0 & W & TX\_TC\_DLY\_VALUE [95:48] \\
\hline
0x5540 & \multicolumn{2}{|l|}{GBT\_TX\_OPT} &
47:0 & W & TX\_OPT \\
\hline
0x5550 & \multicolumn{2}{|l|}{GBT\_RX\_OPT} &
47:0 & W & RX\_OPT \\
\hline
0x5560 & \multicolumn{5}{|l|}{GBT\_DATA\_TXFORMAT} \\
\cline{2-6}
 & & BF1 & 55:32 & W & DATA\_TXFORMAT [47:24] \\
 & & BF2 & 23:0 & W & DATA\_TXFORMAT [23:0] \\
\hline
0x5570 & \multicolumn{5}{|l|}{GBT\_DATA\_RXFORMAT} \\
\cline{2-6}
 & & BF1 & 55:32 & W & DATA\_RXFORMAT [47:24] \\
 & & BF2 & 23:0 & W & DATA\_RXFORMAT [23:0] \\
\hline
0x5580 & \multicolumn{5}{|l|}{GBT\_TX\_RESET} \\
\cline{2-6}
 & & BF1 & 27:16 & W & TX Logic reset [23:12] \\
 & & BF2 & 11:0 & W & TX Logic reset [11:0] \\
\hline
0x5590 & \multicolumn{5}{|l|}{GBT\_RX\_RESET} \\
\cline{2-6}
 & & BF1 & 27:16 & W & RX Logic reset [23:12] \\
 & & BF2 & 11:0 & W & RX Logic reset [11:0] \\
\hline
0x55A0 & \multicolumn{5}{|l|}{GBT\_TX\_TC\_METHOD} \\
\cline{2-6}
 & & BF1 & 27:16 & W & TX time domain crossing method [23:12] \\
 & & BF2 & 11:0 & W & TX time domain crossing method [11:0] \\
\hline
0x55B0 & \multicolumn{5}{|l|}{GBT\_OUTMUX\_SEL} \\
\cline{2-6}
 & & BF1 & 27:16 & W & Descrambler output MUX selection [23:12] \\
 & & BF2 & 11:0 & W & Descrambler output MUX selection [11:0] \\
\hline
0x5600 & \multicolumn{2}{|l|}{GBT\_DNLNK\_FO\_SEL} &
31:0 & W & ToHost FanOut/Selector. Every bitfield is a channel:\newline   1 : GBT\_EMU, select GBT Emulator for a specific CentralRouter channel\newline   0 : GBT\_WRAP, select real GBT link for a specific CentralRouter channel\newline  \\
\hline
0x5610 & \multicolumn{2}{|l|}{GBT\_UPLNK\_FO\_SEL} &
31:0 & W & ToFrontEnd FanOut/Selector. Every bitfield is a channel:\newline   1 : GBT\_EMU, select GBT Emulator for a specific GBT link\newline   0 : TTC\_DEC, select CentralRouter data (including TTC) for a specific GBT link\newline  \\
\hline
\multicolumn{6}{|c|}{GBT Wrapper Monitors} \\
\hline
0x6600 & \multicolumn{5}{|l|}{GBT\_VERSION} \\
\cline{2-6}
 & & DATA & 63:48 & R & Data \\
 & & GBT\_VERSION & 47:32 & R & GBT Version \\
 & & GTH\_IP\_VERSION & 31:16 & R & GTH IP Version \\
 & & RESERVED & 15:3 & R & Reserved \\
 & & GTHREFCLK\_SEL & 2 & R & GTHREFCLK SEL \\
 & & RX\_CLK\_SEL & 1 & R & RX CLK SEL \\
 & & PLL\_SEL & 0 & R & PLL SEL \\
\hline
0x6680 & \multicolumn{5}{|l|}{GBT\_TXRESET\_DONE} \\
\cline{2-6}
 & & BF1 & 27:16 & R & TX Reset done [23:12] \\
 & & BF2 & 11:0 & R & TX Reset done [11:0] \\
\hline
0x6690 & \multicolumn{5}{|l|}{GBT\_RXRESET\_DONE} \\
\cline{2-6}
 & & BF1 & 27:16 & R & RX Reset done [23:12] \\
 & & BF2 & 11:0 & R & RX Reset done [11:0] \\
\hline
0x66A0 & \multicolumn{5}{|l|}{GBT\_TXFSMRESET\_DONE} \\
\cline{2-6}
 & & BF1 & 27:16 & R & TX FSM Reset done [23:12] \\
 & & BF2 & 11:0 & R & TX FSM Reset done [11:0] \\
\hline
0x66B0 & \multicolumn{5}{|l|}{GBT\_RXFSMRESET\_DONE} \\
\cline{2-6}
 & & BF1 & 27:16 & R & RX FSM Reset done [23:12] \\
 & & BF2 & 11:0 & R & RX FSM Reset done [11:0] \\
\hline
0x66C0 & \multicolumn{5}{|l|}{GBT\_CPLL\_FBCLK\_LOST} \\
\cline{2-6}
 & & BF1 & 27:16 & R & CPLL FBCLK LOST [23:12] \\
 & & BF2 & 11:0 & R & CPLL FBCLK LOST [11:0] \\
\hline
0x66D0 & \multicolumn{5}{|l|}{GBT\_CPLL\_LOCK} \\
\cline{2-6}
 & & BF1 & 30:28 & R & QPLL LOCK [5:3] \\
 & & BF2 & 27:16 & R & CPLL LOCK [23:12] \\
 & & BF3 & 14:12 & R & QPLL LOCK [2:0] \\
 & & BF4 & 11:0 & R & CPLL LOCK [11:0] \\
\hline
0x66E0 & \multicolumn{5}{|l|}{GBT\_RXCDR\_LOCK} \\
\cline{2-6}
 & & BF1 & 27:16 & R & RX CDR LOCK [23:12] \\
 & & BF2 & 11:0 & R & RX CDR LOCK [11:0] \\
\hline
0x66F0 & \multicolumn{5}{|l|}{GBT\_CLK\_SAMPLED} \\
\cline{2-6}
 & & BF1 & 27:16 & R & clk sampled [23:12] \\
 & & BF2 & 11:0 & R & clk sampled [11:0] \\
\hline
0x6700 & \multicolumn{5}{|l|}{GBT\_RX\_IS\_HEADER} \\
\cline{2-6}
 & & BF1 & 27:16 & R & RX IS HEADER [23:12] \\
 & & BF2 & 11:0 & R & RX IS HEADER [11:0] \\
\hline
0x6710 & \multicolumn{5}{|l|}{GBT\_RX\_IS\_DATA} \\
\cline{2-6}
 & & BF1 & 27:16 & R & RX IS DATA [23:12] \\
 & & BF2 & 11:0 & R & RX IS DATA [11:0] \\
\hline
0x6720 & \multicolumn{5}{|l|}{GBT\_RX\_HEADER\_FOUND} \\
\cline{2-6}
 & & BF1 & 27:16 & R & RX HEADER FOUND [23:12] \\
 & & BF2 & 11:0 & R & RX HEADER FOUND [11:0] \\
\hline
0x6730 & \multicolumn{5}{|l|}{GBT\_ALIGNMENT\_DONE} \\
\cline{2-6}
 & & BF1 & 27:16 & R & RX ALIGNMENT DONE [23:12] \\
 & & BF2 & 11:0 & R & RX ALIGNMENT DONE [11:0] \\
\hline
0x6740 & \multicolumn{5}{|l|}{GBT\_OUT\_MUX\_STATUS} \\
\cline{2-6}
 & & BF1 & 27:16 & R & GBT output mux status [23:12] \\
 & & BF2 & 11:0 & R & GBT output mux status [11:0] \\
\hline
0x6750 & \multicolumn{5}{|l|}{GBT\_ERROR} \\
\cline{2-6}
 & & BF1 & 27:16 & R & Error flags [23:12] \\
 & & BF2 & 11:0 & R & Error flags [11:0] \\
\hline
0x6760 & \multicolumn{5}{|l|}{GBT\_GBT\_TOPBOT\_C} \\
\cline{2-6}
 & & BF1 & 27:16 & R & TopBot\_c [23:12] \\
 & & BF2 & 11:0 & R & TopBot\_c [11:0] \\
\hline
\multicolumn{6}{|c|}{House Keeping Controls And Monitors} \\
\hline
0x7200 & \multicolumn{5}{|l|}{HK\_CTRL\_CDCE} \\
\cline{2-6}
 & & REF\_SEL & 2 & W & REF\_SEL \\
 & & PD & 1 & W & PD \\
 & & SYNC & 0 & W & SYNC \\
\hline
0x7210 & \multicolumn{5}{|l|}{HK\_CTRL} \\
\cline{2-6}
 & & I2C\_CONFIG\_TRIG & 1 & W & i2c\_config\_trig \\
 & & I2C\_CLKFREQ\_SEL & 0 & W & i2c\_clkfreq\_sel \\
\hline
0x7300 & \multicolumn{2}{|l|}{PLL\_LOCK} &
0 & R & Main MMCM PLL Lock Status \\
\hline
0x7310 & \multicolumn{5}{|l|}{HK\_MON} \\
\cline{2-6}
 & & CDCE\_PLL\_LOCK & 1 & R & CDCE\_PLL\_LOCK \\
 & & I2C\_ACK\_ERROR & 0 & R & i2c\_ack\_error \\
\hline
0x7400 & \multicolumn{5}{|l|}{SPI\_WR} \\
\cline{2-6}
 & & SPI\_FULL & 32 & R & SPI FIFO Full \\
 & & SPI\_DIN & 31:0 & W & SPI WRITE Data \\
 & & SPI\_WREN & any & T & Any write to this register triggers an SPI Write \\
\hline
0x7410 & \multicolumn{5}{|l|}{SPI\_RD} \\
\cline{2-6}
 & & SPI\_EMPTY & 32 & R & SPI FIFO Empty \\
 & & SPI\_DOUT & 31:0 & R & SPI READ Data \\
 & & SPI\_RDEN & any & T & Any write to this register pops the last SPI data from the FIFO \\
\hline
0x7420 & \multicolumn{5}{|l|}{I2C\_WR} \\
\cline{2-6}
 & & I2C\_FULL & 25 & R & I2C FIFO full \\
 & & BF2 & 24 & W & Write two bytes \\
 & & BF3 & 23:16 & W & Data byte 2 \\
 & & BF4 & 15:8 & W & Data byte 1 \\
 & & BF5 & 7:1 & W & Slave address \\
 & & BF6 & 0 & W & READ/<o>WRITE</o> \\
 & & I2C\_WREN & any & T & Any write to this register triggers an I2C read or write sequence \\
\hline
0x7430 & \multicolumn{5}{|l|}{I2C\_RD} \\
\cline{2-6}
 & & I2C\_EMPTY & 8 & R & I2C FIFO Empty \\
 & & I2C\_DOUT & 7:0 & R & I2C READ Data \\
 & & I2C\_RDEN & any & T & Any write to this register pops the last I2C data from the FIFO \\
\hline
0x7500 & \multicolumn{2}{|l|}{DEBUG\_PORT\_CLK} &
3:0 & W & Debug clock and L1A port on SMA HTGx\#4 \\
\hline
0x7510 & \multicolumn{2}{|l|}{DEBUG\_PORT\_GBT} &
6:0 & W & Debug GBT data bit N (119..0) on SMA HTGx\#3 \\
\hline
0x7800 & \multicolumn{2}{|l|}{INT\_TEST\_2} &
any & T & Fire a test MSIx interrupt \#2 \\
\hline
0x7810 & \multicolumn{2}{|l|}{INT\_TEST\_3} &
any & T & Fire a test MSIx interrupt \#3 \\
\hline
\caption{FELIX register map BAR2}\label{tab:dma_register_map_bar2} \\
\end{longtabu}
%\end{landscape}

\newpage

\end{document}