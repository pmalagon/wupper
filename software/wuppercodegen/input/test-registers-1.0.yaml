Registers:
  version: '1.0'
  warning: |
    ***************************************************************************
    ***************************************************************************
    ***************************************************************************
    ***************************************************************************
    ***************************************************************************
    DO NOT EDIT THIS FILE

    This file was generated from '{{ metadata.template }}', version {{ tree.version }}
    by the script '{{ metadata.name }}', version: {{ metadata.version }}, using the following commandline:

    {{ metadata.cmdline }}

    Please do NOT edit this file, but edit the source file at '{{ metadata.template }}'

    ***************************************************************************
    ***************************************************************************
    ***************************************************************************
    ***************************************************************************
    ***************************************************************************

  type: R
  step: 0x010
  default: 0
  entries:
    - ref: Bar0
      offset: 0x0000
    - ref: Bar1
      offset: 0x0000
    - ref: Bar2
      offset: 0x0000

Bar0:
  entries:
    - ref: DMA_DESC
    - ref: DMA_DESC_STATUS
      offset: 0x0200
    - name: BAR0_VALUE
      offset: 0x0300
      bitfield:
        - range: 31..0
          desc: Copy of BAR0 offset reg.
    - name: BAR1_VALUE
      bitfield:
        - range: 31..0
          desc: Copy of BAR1 offset reg.
    - name: BAR2_VALUE
      bitfield:
        - range: 31..0
          desc: Copy of BAR2 offset reg.
    - name: DMA_DESC_ENABLE
      offset: 0x0400
      bitfield:
        - range: 7..0
          type: W
          desc: Enable descriptors 7:0. One bit per descriptor. Cleared when Descriptor is handled.
    - name: DMA_FIFO_FLUSH
      type: T
      bitfield:
        - range: any
          desc: Flush (reset). Any write clears the DMA Main output FIFO
    - name: DMA_RESET
      type: T
      bitfield:
        - range: any
          desc: Reset Wupper Core (DMA Controller FSMs)
    - name: SOFT_RESET
      type: T
      bitfield:
        - range: any
          desc: Global Software Reset. Any write resets applications, e.g. the Central Router.

DMA_DESC:
  number: 8
  type: W
  entries:
    - name: DMA_DESC_{index}
      bitfield:
        - range: 127..64
          name: END_ADDRESS
          desc: End Address
        - range: 63..0
          name: START_ADDRESS
          desc: Start Address
    - name: DMA_DESC_{index}a
      bitfield:
        - range: 127..64
          name: RD_POINTER
          desc: PC Read Pointer
      bitfield:
        - range: 12
          name: WRAP_AROUND
          desc: Wrap around
      bitfield:
        - range: 11
          name: READ_WRITE
          desc: Read/<o>Write</o>
      bitfield:
        - range: 10..0
          name: NUM_WORDS
          desc: Number of 32 bit words

DMA_DESC_STATUS:
  number: 8
  entries:
    - name: DMA_DESC_STATUS_{index}
      bitfield:
        - range: 66
          name: EVEN_PC
          desc: Even address cycle PC
        - range: 65
          name: EVEN_DMA
          desc: Even address cycle DMA
        - range: 64
          name: DESC_DONE
          desc: Descriptor Done
        - range: 63..0
          name: CURRENT_ADDRESS
          desc: Current Address

Bar1:
  entries:
    - ref: INT_VEC
    - name: INT_TAB_ENABLE
      bitfield:
        - range: 7..0
          desc: |
            Interrupt Table enable
            Selectively enable Interrupts

INT_VEC:
  number: 8
  type: W
  entries:
    - name: INT_VEC_{index}
      bitfield:
        - range: 127..96
          name: INT_CTRL
          desc: Interrupt Control
        - range: 95..64
          name: INT_DATA
          desc: Interrupt Data
        - range: 64..0
          name: INT_ADDRESS
          desc: Interrupt Address

Bar2:
  entries:
    - ref: GenericBoardInformation
      offset: 0x0000
    - ref: CentralRouterControls
      offset: 0x1000
    - ref: CentralRouterMonitors
      offset: 0x3000
    - ref: GBTEmulatorControlsAndMonitors
      offset: 0x4000
    - ref: GBTWrapperControls
      offset: 0x5000
    - ref: GBTWrapperMonitors
      offset: 0x6000
    - ref: HouseKeepingControlsAndMonitors
      offset: 0x7000

GenericBoardInformation:
  entries:
    - name: BOARD_ID_TIMESTAMP
      bitfield:
        - range: 79..64
          desc: Board ID Date / Time in BCD format YYMMDDhhmm

    - name: BOARD_ID_SVN
      offset: 0x0008
      bitfield:
        - range: 15..0
          desc: Board ID SVN Revision

    - name: STATUS_LEDS
      offset: 0x0010
      type: W
      bitfield:
        - range: 7..0
          default: 0xAB
          desc: Board GPIO Leds

    - name: GENERIC_CONSTANTS{bitfield}
      bitfield:
        - range: 15..8
          name: INTERRUPTS
          desc: Number of Interrupts
        - range: 7..0
          name: DESCRIPTORS
          desc: Number of Descriptors

    - name: NUM_OF_CHANNELS
      bitfield:
        - range: 7..0
          desc: Number of GBT Channels

    - name: CARD_TYPE
      bitfield:
        - range: 63..0
          desc: |
            Card Type:
              - 709: VC709
              - 710: HTG710

    - name: GBT_MAPPING
      bitfield:
        - range: 7..0
          desc: |
            CXP-to-GBT mapping:
              0: NORMAL CXP1 1-12 CXP2 13-24
              1: ALTERNATE CXP1 1-4,9-12,17-20

CentralRouterControls:
  offset: 0x0100
  desc: See Central Router Doc
  entries:
    - ref: CR_GBT_EGROUP_CONTROL
    - name: CR_TH_UPDATE_CTRL
      type: T
      value: 1
      bitfield:
        - range: any
    - name: CR_FH_UPDATE_CTRL
      type: T
      value: 1
      bitfield:
        - range: any

CR_GBT_EGROUP_CONTROL:
  number: 24
  type: W
  bitfield:
    - range: 63..0
  entries:
    - ref: CR_GBT_TH_{index}
    - ref: CR_GBT_FH_{index}

CR_GBT_TH_{index}:
  number: 7
  format_name: GBT{index:02}
  entries:
    - name: TH
      desc: See Central Router Doc, indices [5,6] are optimized out in wideMode
      format_name: CR_{name}_{parent}_EGROUP{index:1}_CTRL

CR_GBT_FH_{index}:
  number: 5
  format_name: GBT{index:02}
  entries:
    - name: FH
      desc: See Central Router Doc, indices [3,4] are optimized out in wideMode
      format_name: CR_{name}_{parent}_EGROUP{index:1}_CTRL

CentralRouterMonitors:
  desc: See Central Router Doc
  entries:
    - ref: GBT_MON

GBT_MON:
  number: 24
  bitfield:
    - range: 63..0
  entries:
    - name: CR_TH_GBT{index:02}_MON
    - name: CR_FH_GBT{index:02}_MON

GBTEmulatorControlsAndMonitors:
  entries:
    - name: GBT_EMU_ENA{bitfield}
      type: W
      bitfield:
        - range: 1
          name: TOHOST
          desc: Enable GBT dummy emulator ToHost
        - range: 0
          name: TOFRONTEND
          desc: Enable GBT dummy emulator ToFrontEnd

    - name: GBT_EMU_CONFIG{bitfield}
      type: W
      bitfield:
        - range: 70..64
          name: WE_ARRAY
          desc: write enable array, every bit is one emulator RAM block
        - range: 45..32
          name: WRADDR
          desc: write address bus
        - range: 15..0
          name: WRDATA
          desc: write data bus

GBTWrapperControls:
  type: W
  entries:
    - name: GBT_LOGIC_RESET
      offset: 0x0400
      bitfield:
        - range: 63..0
          desc: Not internally connected (?)

    - name: GBT_GENERAL_CTRL
      bitfield:
        - range: 0
          desc: Alignment chk reset (not self clearing)

    - name: GBT_MODE_CTRL{bitfield}
      bitfield:
        - range: 2
          name: DESMUX_USE_SW
          desc: DESMUX_USE_SW
        - range: 1
          name: RX_ALIGN_SW
          desc: RX_ALIGN_SW
        - range: 0
          name: RX_ALIGN_TB_SW
          desc: RX_ALIGN_TB_SW

    - name: GBT_RXSLIDE{bitfield}
      offset: 0x0480
      bitfield:
        - range: 59..48
          name: BF1
          desc: RxSlide select [23:12]
        - range: 43..32
          name: BF2
          desc: RxSlide select [11:0]
        - range: 27..16
          name: BF3
          desc: RxSlide manual [23:12
        - range: 11..0
          name: BF4
          desc: RxSlide manual [11:0]

    - name: GBT_TXUSRRDY{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          default: 0xFFF
          desc: TxUsrRdy [23:12]
        - range: 11..0
          name: BF2
          default: 0xFFF
          desc: TxUsrRdy [11:0]

    - name: GBT_RXUSRRDY{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          default: 0xFFF
          desc: RxUsrRdy [23:12]
        - range: 11..0
          name: BF2
          default: 0xFFF
          desc: RxUsrRdy [11:0]

    - name: GBT_GTTX_RESET{bitfield}
      bitfield:
        - range: 30..28
          name: BF1
          desc: SOFT_RESET [5:3]
        - range: 27..16
          name: BF2
          desc: GTTX_RESET [23:12]
        - range: 14..12
          name: BF3
          desc: SOFT_RESET [2:0]
        - range: 11..0
          name: BF4
          desc: GTTX_RESET [11:0]

    - name: GBT_GTRX_RESET{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: GTRX_RESET [23:0]
        - range: 11..0
          name: BF2
          desc: GTRX_RESET [11:0]

    - name: GBT_PLL_RESET{bitfield}
      bitfield:
        - range: 30..28
          name: BF1
          desc: QPLL_RESET [5:3]
        - range: 27..16
          name: BF2
          desc: CPLL_RESET [23:12]
        - range: 14..12
          name: BF3
          desc: QPLL_RESET [2:0]
        - range: 11..0
          name: BF4
          desc: CPLL_RESET [11:0]

    - name: GBT_SOFT_TX_RESET{bitfield}
      bitfield:
        - range: 30..28
          name: BF1
          desc: SOFT_TX_RESET_ALL [5:3]
        - range: 27..16
          name: BF2
          desc: SOFT_TX_RESET_GT [23:12]
        - range: 14..12
          name: BF3
          desc: SOFT_TX_RESET_ALL [2:0]
        - range: 11..0
          name: BF4
          desc: SOFT_TX_RESET_GT [11:0]

    - name: GBT_SOFT_RX_RESET{bitfield}
      bitfield:
        - range: 30..28
          name: BF1
          desc: SOFT_RX_RESET_ALL [5:3]
        - range: 27..16
          name: BF2
          desc: SOFT_RX_RESET_GT [23:12]
        - range: 14..12
          name: BF3
          desc: SOFT_RX_RESET_ALL [2:0]
        - range: 11..0
          name: BF4
          desc: SOFT_RX_RESET_GT [11:0]

    - name: GBT_ODD_EVEN{bitfield}
      offset: 0x0500
      bitfield:
        - range: 27..16
          name: BF1
          desc: OddEven [23:12]
        - range: 11..0
          name: BF2
          desc: OddEven [11:0]

    - name: GBT_TOPBOT{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: TopBot [23:12]
        - range: 11..0
          name: BF2
          desc: TopBot [11:0]

    - name: GBT_TX_TC_DLY_VALUE1
      bitfield:
        - range: 47..0
          desc: TX_TC_DLY_VALUE [47:0]

    - name: GBT_TX_TC_DLY_VALUE2
      bitfield:
        - range: 47..0
          desc: TX_TC_DLY_VALUE [95:48]

    - name: GBT_TX_OPT
      bitfield:
        - range: 47..0
          default: 0x0000000000555555
          desc: TX_OPT

    - name: GBT_RX_OPT
      bitfield:
        - range: 47..0
          default: 0x0000000000555555
          desc: RX_OPT

    - name: GBT_DATA_TXFORMAT{bitfield}
      bitfield:
        - range: 55..32
          name: BF1
          desc: DATA_TXFORMAT [47:24]
        - range: 23..0
          name: BF2
          desc: DATA_TXFORMAT [23:0]

    - name: GBT_DATA_RXFORMAT{bitfield}
      bitfield:
        - range: 55..32
          name: BF1
          desc: DATA_RXFORMAT [47:24]
        - range: 23..0
          name: BF2
          desc: DATA_RXFORMAT [23:0]

    - name: GBT_TX_RESET{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: TX Logic reset [23:12]
        - range: 11..0
          name: BF2
          desc: TX Logic reset [11:0]

    - name: GBT_RX_RESET{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: RX Logic reset [23:12]
        - range: 11..0
          name: BF2
          desc: RX Logic reset [11:0]

    - name: GBT_TX_TC_METHOD{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: TX time domain crossing method [23:12]
        - range: 11..0
          name: BF2
          desc: TX time domain crossing method [11:0]

    - name: GBT_OUTMUX_SEL{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: Descrambler output MUX selection [23:12]
        - range: 11..0
          name: BF2
          desc: Descrambler output MUX selection [11:0]

    - name: GBT_DNLNK_FO_SEL
      offset: 0x0600
      bitfield:
        - range: 31..0
          default: 0xFFFFFFFF
          desc: |
            ToHost FanOut/Selector. Every bitfield is a channel:
              1 : GBT_EMU, select GBT Emulator for a specific CentralRouter channel
              0 : GBT_WRAP, select real GBT link for a specific CentralRouter channel

    - name: GBT_UPLNK_FO_SEL
      bitfield:
        - range: 31..0
          default: 0xFFFFFFFF
          desc: |
            ToFrontEnd FanOut/Selector. Every bitfield is a channel:
              1 : GBT_EMU, select GBT Emulator for a specific GBT link
              0 : TTC_DEC, select CentralRouter data (including TTC) for a specific GBT link

GBTWrapperMonitors:
  entries:
    - name: GBT_VERSION{bitfield}
      offset: 0x0600
      bitfield:
        - range: 63..48
          name: DATA
          desc: Data
        - range: 47..32
          name: GBT_VERSION
          desc: GBT Version
        - range: 31..16
          name: GTH_IP_VERSION
          desc: GTH IP Version
        - range: 15..3
          name: RESERVED
          desc: Reserved
        - range: 2
          name: GTHREFCLK_SEL
          desc: GTHREFCLK SEL
        - range: 1
          name: RX_CLK_SEL
          desc: RX CLK SEL
        - range: 0
          name: PLL_SEL
          desc: PLL SEL

    - name: GBT_TXRESET_DONE{bitfield}
      offset: 0x0680
      bitfield:
        - range: 27..16
          name: BF1
          desc: TX Reset done [23:12]
        - range: 11..0
          name: BF2
          desc: TX Reset done [11:0]

    - name: GBT_RXRESET_DONE{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: RX Reset done [23:12]
        - range: 11..0
          name: BF2
          desc: RX Reset done [11:0]

    - name: GBT_TXFSMRESET_DONE{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: TX FSM Reset done [23:12]
        - range: 11..0
          name: BF2
          desc: TX FSM Reset done [11:0]

    - name: GBT_RXFSMRESET_DONE{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: RX FSM Reset done [23:12]
        - range: 11..0
          name: BF2
          desc: RX FSM Reset done [11:0]

    - name: GBT_CPLL_FBCLK_LOST{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: CPLL FBCLK LOST [23:12]
        - range: 11..0
          name: BF2
          desc: CPLL FBCLK LOST [11:0]

    - name: GBT_CPLL_LOCK{bitfield}
      bitfield:
        - range: 30..28
          name: BF1
          desc: QPLL LOCK [5:3]
        - range: 27..16
          name: BF2
          desc: CPLL LOCK [23:12]
        - range: 14..12
          name: BF3
          desc: QPLL LOCK [2:0]
        - range: 11..0
          name: BF4
          desc: CPLL LOCK [11:0]

    - name: GBT_RXCDR_LOCK{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: RX CDR LOCK [23:12]
        - range: 11..0
          name: BF2
          desc: RX CDR LOCK [11:0]

    - name: GBT_CLK_SAMPLED{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: clk sampled [23:12]
        - range: 11..0
          name: BF2
          desc: clk sampled [11:0]

    - name: GBT_RX_IS_HEADER{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: RX IS HEADER [23:12]
        - range: 11..0
          name: BF2
          desc: RX IS HEADER [11:0]

    - name: GBT_RX_IS_DATA{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: RX IS DATA [23:12]
        - range: 11..0
          name: BF2
          desc: RX IS DATA [11:0]

    - name: GBT_RX_HEADER_FOUND{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: RX HEADER FOUND [23:12]
        - range: 11..0
          name: BF2
          desc: RX HEADER FOUND [11:0]

    - name: GBT_ALIGNMENT_DONE{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: RX ALIGNMENT DONE [23:12]
        - range: 11..0
          name: BF2
          desc: RX ALIGNMENT DONE [11:0]

    - name: GBT_OUT_MUX_STATUS{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: GBT output mux status [23:12]
        - range: 11..0
          name: BF2
          desc: GBT output mux status [11:0]

    - name: GBT_ERROR{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: Error flags [23:12]
        - range: 11..0
          name: BF2
          desc: Error flags [11:0]

    - name: GBT_GBT_TOPBOT_C{bitfield}
      bitfield:
        - range: 27..16
          name: BF1
          desc: TopBot_c [23:12]
        - range: 11..0
          name: BF2
          desc: TopBot_c [11:0]

HouseKeepingControlsAndMonitors:
  entries:
    - name: HK_CTRL_I2C{bitfield}
      offset: 0x0200
      type: W
      bitfield:
        - range: 1
          name: CONFIG_TRIG
          desc: i2c_config_trig
        - range: 0
          name: CLKFREQ_SEL
          desc: i2c_clkfreq_sel

    - name: HK_CTRL_CDCE{bitfield}
      offset: 0x0208
      type: W
      bitfield:
        - range: 2
          name: REF_SEL
          desc: REF_SEL
        - range: 1
          name: PD
          desc: PD
        - range: 0
          name: SYNC
          desc: SYNC

    - name: PLL_LOCK
      offset: 0x0300
      bitfield:
        - range: 0
          desc: Main MMCM PLL Lock Status

    - name: HK_MON{bitfield}
      bitfield:
        - range: 1
          name: CDCE_PLL_LOCK
          desc: CDCE_PLL_LOCK
        - range: 0
          name: I2C_ACK_ERROR
          desc: i2c_ack_error

    - name: SPI_WR{bitfield}
      offset: 0x0400
      bitfield:
        - range: 32
          name: SPI_FULL
          desc: SPI FIFO Full
        - range: 31..0
          type: W
          name: SPI_DIN
          desc: SPI WRITE Data
        - range: any
          type: T
          value: not register_map_monitor_s.register_map_hk_monitor.SPI_WR_SPI_FULL
          name: SPI_WREN
          desc: Any write to this register triggers an SPI Write

    - name: SPI_RD{bitfield}
      bitfield:
        - range: 32
          name: SPI_EMPTY
          desc: SPI FIFO Empty
        - range: 31..0
          name: SPI_DOUT
          desc: SPI READ Data
        - range: any
          type: T
          value: 1
          name: SPI_RDEN
          desc: Any write to this register pops the last SPI data from the FIFO

    - name: I2C_WR{bitfield}
      bitfield:
        - range: 25
          name: I2C_FULL
          desc: I2C FIFO full
        - range: 24
          name: BF2
          type: W
          desc: Write two bytes
        - range: 23..16
          name: BF3
          type: W
          desc: Data byte 2
        - range: 15..8
          name: BF4
          type: W
          desc: Data byte 1
        - range: 7..1
          name: BF5
          type: W
          desc: Slave address
        - range: 0
          name: BF6
          type: W
          desc: READ/<o>WRITE</o>
        - range: any
          name: I2C_WREN
          type: T
          value: not register_map_monitor_s.register_map_hk_monitor.I2C_WR_I2C_FULL
          desc: Any write to this register triggers an I2C read or write sequence

    - name: I2C_RD{bitfield}
      bitfield:
        - range: 8
          name: I2C_EMPTY
          desc: I2C FIFO Empty
        - range: 7..0
          name: I2C_DOUT
          desc: I2C READ Data
        - range: any
          name: I2C_RDEN
          type: T
          value: 1
          desc: Any write to this register pops the last I2C data from the FIFO

    - name: DEBUG_PORT{bitfield}
      offset: 0x0500
      type: W
      bitfield:
        - range: 67..63
          name: CLK
          desc: Debug clock and L1A port on SMA HTGx#4
        - range: 6..0
          name: GBT
          desc: Debug GBT data bit N (119..0) on SMA HTGx#3

    - name: INT_TEST_2
      offset: 0x0800
      type: T
      value: 1
      bitfield:
        - range: any
          desc: Fire a test MSIx interrupt \#2

    - name: INT_TEST_3
      type: T
      value: 1
      bitfield:
        - range: any
          desc: Fire a test MSIx interrupt \#3
